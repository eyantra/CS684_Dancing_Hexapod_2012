<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Dancing Hexapod: BeatDetector.java Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Dancing Hexapod
   
   </div>
   <div id="projectbrief">dancing hexapod</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('BeatDetector_8java.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">BeatDetector.java</div>  </div>
</div><!--header-->
<div class="contents">
<a href="BeatDetector_8java.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00023"></a>00023 <span class="keyword">package </span>com.iitb.beatdetector;
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="keyword">import</span> java.io.FileNotFoundException;
<a name="l00026"></a>00026 <span class="keyword">import</span> java.io.FileWriter;
<a name="l00027"></a>00027 <span class="keyword">import</span> java.io.IOException;
<a name="l00028"></a>00028 <span class="keyword">import</span> java.io.PrintWriter;
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="keyword">import</span> com.musicg.wave.Wave;
<a name="l00031"></a>00031 <span class="keyword">import</span> com.musicg.wave.WaveHeader;
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html">00033</a> <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html">BeatDetector</a> {
<a name="l00035"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ac8c95aea3c979efe3fed52098479b80d">00035</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ac8c95aea3c979efe3fed52098479b80d" title="total number of samples in the song">numOfSamples</a>;
<a name="l00036"></a>00036         
<a name="l00038"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a9a258dda32e242f513ef26aa60446df7">00038</a>         <span class="keyword">private</span> <span class="keywordtype">short</span>[] <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a9a258dda32e242f513ef26aa60446df7" title="the array of amplitudes for every sample">amplitudes</a>;
<a name="l00039"></a>00039         
<a name="l00041"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aa7474069231fe43f4f5a7695684e3abb">00041</a>         <span class="keyword">private</span> <span class="keywordtype">double</span>[] <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aa7474069231fe43f4f5a7695684e3abb" title="the array containing the avg energy in a chunk of samples">chunkEnergyArray</a>;
<a name="l00042"></a>00042         
<a name="l00044"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a70d72c667d79ba3a7c4ba5e420d40ee6">00044</a>         <span class="keyword">private</span> <span class="keywordtype">double</span>[] <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a70d72c667d79ba3a7c4ba5e420d40ee6" title="the array obtained after thresholding the chunk energies">thresholdedChunkEnergy</a>;
<a name="l00045"></a>00045         
<a name="l00047"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a60c09d110a321b808e92cc54dd3caa7b">00047</a>         <span class="keyword">private</span> <span class="keywordtype">short</span>[] <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a60c09d110a321b808e92cc54dd3caa7b" title="the array obtained after performing thinning on the thresholded array">thinnedChunkEnergy</a>;
<a name="l00048"></a>00048         
<a name="l00050"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4">00050</a>         <span class="keyword">private</span> <span class="keywordtype">int</span>[] <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4" title="the array holds the location corresponding to the beats ( start of a beat)">beatChunkLocations</a>;
<a name="l00051"></a>00051         
<a name="l00053"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4b8828159722fc47dc8547d35fe8060e">00053</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4b8828159722fc47dc8547d35fe8060e" title="number of total beats detected in the song">numOfBeats</a>;
<a name="l00054"></a>00054         
<a name="l00056"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a0c609df4cd08e7f636f54a06fe7cf1d2">00056</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a0c609df4cd08e7f636f54a06fe7cf1d2" title="number of beats in a period ( period represents the repetition period of the song)">numOfBeatsInPeriod</a>;
<a name="l00057"></a>00057         
<a name="l00059"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#afcc7e14849a5a6b6e2adb80336f0845f">00059</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#afcc7e14849a5a6b6e2adb80336f0845f" title="the sampling rate of the song.">samplingRate</a>;
<a name="l00060"></a>00060         
<a name="l00062"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19">00062</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>;
<a name="l00063"></a>00063         
<a name="l00065"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aab0fed93a02fa372754b110eed17a087">00065</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aab0fed93a02fa372754b110eed17a087" title="size of a chunk : represents the number of samples in a chunk.">sizeOfChunk</a>;
<a name="l00066"></a>00066         
<a name="l00068"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ae27938094b71014ddcc112320206ed52">00068</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ae27938094b71014ddcc112320206ed52" title="the maximum frequency of beats possible in a song. ( eg: 10 beats per sec. at max)">maxBeatFreq</a>;
<a name="l00069"></a>00069         
<a name="l00071"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a999b051b96512ab0ccfafd5f4df3b7f5">00071</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a999b051b96512ab0ccfafd5f4df3b7f5" title="the chunk index which corresponds to the first beat, also the start of the first period.">startChunkLocation</a>;
<a name="l00072"></a>00072         
<a name="l00074"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a215d72d494726c9ffc7a83f5645fda6d">00074</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a215d72d494726c9ffc7a83f5645fda6d" title="the period/tempo of the song as the number of chunks">periodInChunks</a>;
<a name="l00075"></a>00075         
<a name="l00077"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a177258eba4a10faec38519e4d96adcd7">00077</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a177258eba4a10faec38519e4d96adcd7" title="the period in terms of number of samples.">periodInSamples</a>;
<a name="l00078"></a>00078         
<a name="l00079"></a>00079 
<a name="l00080"></a>00080         <span class="comment">/*</span>
<a name="l00081"></a>00081 <span class="comment">         * The default Constructor</span>
<a name="l00082"></a>00082 <span class="comment">         * Just initialises a few data members.</span>
<a name="l00083"></a>00083 <span class="comment">         */</span>
<a name="l00084"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aefbc58de60757a49aa67f2430b372b88">00084</a>         <span class="keyword">public</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aefbc58de60757a49aa67f2430b372b88">BeatDetector</a>() {
<a name="l00085"></a>00085                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ac8c95aea3c979efe3fed52098479b80d" title="total number of samples in the song">numOfSamples</a> = 0;
<a name="l00086"></a>00086                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a9a258dda32e242f513ef26aa60446df7" title="the array of amplitudes for every sample">amplitudes</a> = <span class="keyword">new</span> <span class="keywordtype">short</span>[<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ac8c95aea3c979efe3fed52098479b80d" title="total number of samples in the song">numOfSamples</a>];
<a name="l00087"></a>00087                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4b8828159722fc47dc8547d35fe8060e" title="number of total beats detected in the song">numOfBeats</a> = 0;
<a name="l00088"></a>00088         }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090         
<a name="l00097"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#acf5e4b8de82bcfbc99e678ed36bffac0">00097</a>         <span class="keyword">public</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#acf5e4b8de82bcfbc99e678ed36bffac0" title="Constructor.">BeatDetector</a>(Wave wave) {
<a name="l00098"></a>00098                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a9a258dda32e242f513ef26aa60446df7" title="the array of amplitudes for every sample">amplitudes</a> = wave.getSampleAmplitudes();
<a name="l00099"></a>00099                 byte[] bytes = wave.getBytes();
<a name="l00100"></a>00100                 WaveHeader wave_header = wave.getWaveHeader();
<a name="l00101"></a>00101                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#afcc7e14849a5a6b6e2adb80336f0845f" title="the sampling rate of the song.">samplingRate</a> = wave_header.getSampleRate();
<a name="l00102"></a>00102                 <span class="keywordtype">int</span> bytePerSample = wave_header.getBitsPerSample() / 8;
<a name="l00103"></a>00103                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ac8c95aea3c979efe3fed52098479b80d" title="total number of samples in the song">numOfSamples</a> = (int) bytes.length / bytePerSample;
<a name="l00104"></a>00104                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4b8828159722fc47dc8547d35fe8060e" title="number of total beats detected in the song">numOfBeats</a> = 0;
<a name="l00105"></a>00105         }
<a name="l00106"></a>00106    
<a name="l00107"></a>00107         
<a name="l00118"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a5283ded808acb512acf4b5cfbd62cc30">00118</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a5283ded808acb512acf4b5cfbd62cc30" title="find the enrgy maximas in the spectrum.">findEnergyMaximas</a>() {
<a name="l00119"></a>00119                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab05aa16f654ab0fbf6d569e473e4e0dc" title="sets the size of the chunk ( to perform averaging)">setSizeOfChunk</a>();
<a name="l00120"></a>00120                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a7fa2b0a18f77dff8a554ae9862bbb409" title="sets the number of chunks in the song">setNumOfChunks</a>();
<a name="l00121"></a>00121                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#acc3f6189668d071255c0991a22fb41c4" title="creates and initialises the array holding the average chunk energies">initialiseChunkEnergyArray</a>();
<a name="l00122"></a>00122                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a88a3e7a796429317fcd91feb65501008" title="fills up the chunk energy array">setChunkEnergyArray</a>();
<a name="l00123"></a>00123                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4d64981214bfd288f039f899cbbdaeb9" title="perform thresholding on the avg chunk energy array to find probable beat locations">thresholdChunkEnergies</a>();
<a name="l00124"></a>00124                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a96a76b1b67b6d3ba46a62c0de9944454" title="perform thinning on the thresholded chunk energy array.">thinThresholdedChunkEnergies</a>();
<a name="l00125"></a>00125         }
<a name="l00126"></a>00126 
<a name="l00134"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a23b72a910ef18f1b600f09b382e414a0">00134</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a23b72a910ef18f1b600f09b382e414a0" title="prints the amplitude per sample to a file">printAmplitudes</a>(String fileName) {
<a name="l00135"></a>00135 
<a name="l00136"></a>00136                 <span class="keywordflow">try</span> {
<a name="l00137"></a>00137                         FileWriter fw = <span class="keyword">new</span> FileWriter(fileName);
<a name="l00138"></a>00138                         PrintWriter pw = <span class="keyword">new</span> PrintWriter(fw);
<a name="l00139"></a>00139                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ac8c95aea3c979efe3fed52098479b80d" title="total number of samples in the song">numOfSamples</a>; i++) {
<a name="l00140"></a>00140                                 pw.println(<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a9a258dda32e242f513ef26aa60446df7" title="the array of amplitudes for every sample">amplitudes</a>[i]);
<a name="l00141"></a>00141                         }
<a name="l00142"></a>00142                         pw.close();
<a name="l00143"></a>00143                         fw.close();
<a name="l00144"></a>00144                 } <span class="keywordflow">catch</span> (FileNotFoundException e) {
<a name="l00145"></a>00145                         e.printStackTrace();
<a name="l00146"></a>00146                 } <span class="keywordflow">catch</span> (IOException e) {
<a name="l00147"></a>00147                         e.printStackTrace();
<a name="l00148"></a>00148                 }
<a name="l00149"></a>00149         }
<a name="l00150"></a>00150 
<a name="l00151"></a>00151         
<a name="l00152"></a>00152         
<a name="l00157"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a7fa2b0a18f77dff8a554ae9862bbb409">00157</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a7fa2b0a18f77dff8a554ae9862bbb409" title="sets the number of chunks in the song">setNumOfChunks</a>() {
<a name="l00158"></a>00158                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a> = (int) <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ac8c95aea3c979efe3fed52098479b80d" title="total number of samples in the song">numOfSamples</a> / <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aab0fed93a02fa372754b110eed17a087" title="size of a chunk : represents the number of samples in a chunk.">sizeOfChunk</a>;
<a name="l00159"></a>00159                 <span class="comment">//System.out.println(&quot;set num of chunks:&quot;+numOfChunks);</span>
<a name="l00160"></a>00160         }
<a name="l00161"></a>00161 
<a name="l00162"></a>00162         
<a name="l00169"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab05aa16f654ab0fbf6d569e473e4e0dc">00169</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab05aa16f654ab0fbf6d569e473e4e0dc" title="sets the size of the chunk ( to perform averaging)">setSizeOfChunk</a>() {
<a name="l00170"></a>00170                 
<a name="l00171"></a>00171                 <span class="keywordtype">double</span> temp = (double) (200 * <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#afcc7e14849a5a6b6e2adb80336f0845f" title="the sampling rate of the song.">samplingRate</a> / 44100);
<a name="l00172"></a>00172                 <span class="comment">//System.out.println(&quot;sampling rate:&quot;+samplingRate);</span>
<a name="l00173"></a>00173                 <span class="comment">//System.out.println(&quot;temp:&quot;+temp);</span>
<a name="l00174"></a>00174                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aab0fed93a02fa372754b110eed17a087" title="size of a chunk : represents the number of samples in a chunk.">sizeOfChunk</a> = (int) temp;
<a name="l00175"></a>00175                 <span class="comment">//System.out.println(&quot;set size of chunks:&quot;+sizeOfChunk);</span>
<a name="l00176"></a>00176         }
<a name="l00177"></a>00177 
<a name="l00178"></a>00178         
<a name="l00182"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#acc3f6189668d071255c0991a22fb41c4">00182</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#acc3f6189668d071255c0991a22fb41c4" title="creates and initialises the array holding the average chunk energies">initialiseChunkEnergyArray</a>() {
<a name="l00183"></a>00183                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aa7474069231fe43f4f5a7695684e3abb" title="the array containing the avg energy in a chunk of samples">chunkEnergyArray</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>];
<a name="l00184"></a>00184         }
<a name="l00185"></a>00185 
<a name="l00186"></a>00186         
<a name="l00187"></a>00187         
<a name="l00193"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a88a3e7a796429317fcd91feb65501008">00193</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a88a3e7a796429317fcd91feb65501008" title="fills up the chunk energy array">setChunkEnergyArray</a>() {
<a name="l00194"></a>00194                 <span class="keywordtype">double</span> temp_sum = 0;
<a name="l00195"></a>00195                 <span class="keywordtype">double</span> temp = 0;
<a name="l00196"></a>00196                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>; i++) {
<a name="l00197"></a>00197                         temp_sum = 0;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aab0fed93a02fa372754b110eed17a087" title="size of a chunk : represents the number of samples in a chunk.">sizeOfChunk</a>; j++) {
<a name="l00200"></a>00200                                 temp = <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a9a258dda32e242f513ef26aa60446df7" title="the array of amplitudes for every sample">amplitudes</a>[i * sizeOfChunk + j];
<a name="l00201"></a>00201                                 temp_sum = temp_sum + temp * temp;
<a name="l00202"></a>00202                         }
<a name="l00203"></a>00203                         temp_sum = (double) temp_sum / sizeOfChunk;
<a name="l00204"></a>00204                         <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aa7474069231fe43f4f5a7695684e3abb" title="the array containing the avg energy in a chunk of samples">chunkEnergyArray</a>[i] = temp_sum / 30000;
<a name="l00205"></a>00205                 }
<a name="l00206"></a>00206         }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208         
<a name="l00209"></a>00209         
<a name="l00217"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aac8a7178b5dc8ad5b855df6fbc5eabd4">00217</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aac8a7178b5dc8ad5b855df6fbc5eabd4" title="prints the avg chunk energies per chunk to a file">printChunkEnergies</a>(String fileName) {
<a name="l00218"></a>00218                 <span class="keywordflow">try</span> {
<a name="l00219"></a>00219                         <span class="comment">//System.out.println(&quot;no of chunks : &quot; + numOfChunks);</span>
<a name="l00220"></a>00220                         FileWriter fw = <span class="keyword">new</span> FileWriter(fileName);
<a name="l00221"></a>00221                         PrintWriter pw = <span class="keyword">new</span> PrintWriter(fw);
<a name="l00222"></a>00222                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>; i++) {
<a name="l00223"></a>00223                                 pw.println(<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aa7474069231fe43f4f5a7695684e3abb" title="the array containing the avg energy in a chunk of samples">chunkEnergyArray</a>[i]);
<a name="l00224"></a>00224                         }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226                         pw.close();
<a name="l00227"></a>00227                         fw.close();
<a name="l00228"></a>00228                 } <span class="keywordflow">catch</span> (FileNotFoundException e) {
<a name="l00229"></a>00229                         e.printStackTrace();
<a name="l00230"></a>00230                 } <span class="keywordflow">catch</span> (IOException e) {
<a name="l00231"></a>00231                         e.printStackTrace();
<a name="l00232"></a>00232                 }
<a name="l00233"></a>00233         }
<a name="l00234"></a>00234 
<a name="l00247"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4d64981214bfd288f039f899cbbdaeb9">00247</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4d64981214bfd288f039f899cbbdaeb9" title="perform thresholding on the avg chunk energy array to find probable beat locations">thresholdChunkEnergies</a>() {
<a name="l00248"></a>00248                 <span class="keywordtype">double</span> max_energy = 0;
<a name="l00249"></a>00249                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>; k++) {
<a name="l00250"></a>00250                         <span class="keywordflow">if</span> (<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aa7474069231fe43f4f5a7695684e3abb" title="the array containing the avg energy in a chunk of samples">chunkEnergyArray</a>[k] &gt; max_energy )
<a name="l00251"></a>00251                                 max_energy = <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aa7474069231fe43f4f5a7695684e3abb" title="the array containing the avg energy in a chunk of samples">chunkEnergyArray</a>[k];
<a name="l00252"></a>00252                 }
<a name="l00253"></a>00253                 <span class="keywordtype">int</span> thresholdFactor = 4; 
<a name="l00254"></a>00254                 <span class="comment">// the factor with which we threshold corresponding to the the maximum energy </span>
<a name="l00255"></a>00255                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a70d72c667d79ba3a7c4ba5e420d40ee6" title="the array obtained after thresholding the chunk energies">thresholdedChunkEnergy</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>];
<a name="l00256"></a>00256                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>; j++) {
<a name="l00257"></a>00257                         <span class="keywordflow">if</span> (<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aa7474069231fe43f4f5a7695684e3abb" title="the array containing the avg energy in a chunk of samples">chunkEnergyArray</a>[j] &gt; max_energy/thresholdFactor)
<a name="l00258"></a>00258                                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a70d72c667d79ba3a7c4ba5e420d40ee6" title="the array obtained after thresholding the chunk energies">thresholdedChunkEnergy</a>[j] = (double) <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aa7474069231fe43f4f5a7695684e3abb" title="the array containing the avg energy in a chunk of samples">chunkEnergyArray</a>[j]/ max_energy;
<a name="l00259"></a>00259                 }
<a name="l00260"></a>00260 
<a name="l00261"></a>00261         }
<a name="l00262"></a>00262 
<a name="l00270"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#af5a7ba99362cd788fa9ff32ac1c172c4">00270</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#af5a7ba99362cd788fa9ff32ac1c172c4" title="prints the thresholded chunk energies per chunk to a file">printThresholdedChunkEnergies</a>(String fileName) {
<a name="l00271"></a>00271                 <span class="keywordflow">try</span> {
<a name="l00272"></a>00272                         <span class="comment">//System.out.println(&quot;num of chunks: &quot; + numOfChunks);</span>
<a name="l00273"></a>00273                         FileWriter fw = <span class="keyword">new</span> FileWriter(fileName);
<a name="l00274"></a>00274                         PrintWriter pw = <span class="keyword">new</span> PrintWriter(fw);
<a name="l00275"></a>00275                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>; i++) {
<a name="l00276"></a>00276                                 pw.println(<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a70d72c667d79ba3a7c4ba5e420d40ee6" title="the array obtained after thresholding the chunk energies">thresholdedChunkEnergy</a>[i]);
<a name="l00277"></a>00277                         }
<a name="l00278"></a>00278 
<a name="l00279"></a>00279                         pw.close();
<a name="l00280"></a>00280                         fw.close();
<a name="l00281"></a>00281                 } <span class="keywordflow">catch</span> (FileNotFoundException e) {
<a name="l00282"></a>00282                         e.printStackTrace();
<a name="l00283"></a>00283                 } <span class="keywordflow">catch</span> (IOException e) {
<a name="l00284"></a>00284                         e.printStackTrace();
<a name="l00285"></a>00285                 }
<a name="l00286"></a>00286         }
<a name="l00287"></a>00287 
<a name="l00288"></a>00288         
<a name="l00304"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a96a76b1b67b6d3ba46a62c0de9944454">00304</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a96a76b1b67b6d3ba46a62c0de9944454" title="perform thinning on the thresholded chunk energy array.">thinThresholdedChunkEnergies</a>() {
<a name="l00305"></a>00305                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ae27938094b71014ddcc112320206ed52" title="the maximum frequency of beats possible in a song. ( eg: 10 beats per sec. at max)">maxBeatFreq</a> = 10; <span class="comment">// i.e there can be at max 10 beats in a seconds.</span>
<a name="l00306"></a>00306                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a60c09d110a321b808e92cc54dd3caa7b" title="the array obtained after performing thinning on the thresholded array">thinnedChunkEnergy</a> = <span class="keyword">new</span> <span class="keywordtype">short</span>[<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>];
<a name="l00307"></a>00307                 <span class="keywordtype">int</span> num_samples_min_beat = <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#afcc7e14849a5a6b6e2adb80336f0845f" title="the sampling rate of the song.">samplingRate</a> / <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ae27938094b71014ddcc112320206ed52" title="the maximum frequency of beats possible in a song. ( eg: 10 beats per sec. at max)">maxBeatFreq</a>;
<a name="l00308"></a>00308                 <span class="keywordtype">int</span> num_chunks_min_beat = num_samples_min_beat / <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aab0fed93a02fa372754b110eed17a087" title="size of a chunk : represents the number of samples in a chunk.">sizeOfChunk</a>;
<a name="l00309"></a>00309 <span class="comment">//              System.out.println(&quot;the num of chunks min beat :&quot; + num_chunks_min_beat);</span>
<a name="l00310"></a>00310                 <span class="keywordtype">int</span> current_beat_index = -1;
<a name="l00311"></a>00311                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>; j++) {
<a name="l00312"></a>00312                         <span class="keywordflow">if</span> (j &gt; current_beat_index) {
<a name="l00313"></a>00313                                 <span class="keywordflow">if</span> (<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a70d72c667d79ba3a7c4ba5e420d40ee6" title="the array obtained after thresholding the chunk energies">thresholdedChunkEnergy</a>[j] &gt; 0) {
<a name="l00314"></a>00314                                         <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a60c09d110a321b808e92cc54dd3caa7b" title="the array obtained after performing thinning on the thresholded array">thinnedChunkEnergy</a>[j] = 1;
<a name="l00315"></a>00315                                         current_beat_index = j;
<a name="l00316"></a>00316                                         current_beat_index = current_beat_index + num_chunks_min_beat;
<a name="l00317"></a>00317 <span class="comment">//                                      System.out.println(&quot;a :&quot; + current_beat_index);</span>
<a name="l00318"></a>00318 <span class="comment">//                                      System.out.println(&quot;k : &quot; + j);</span>
<a name="l00319"></a>00319                                 }
<a name="l00320"></a>00320                         }
<a name="l00321"></a>00321                 }
<a name="l00322"></a>00322         }
<a name="l00323"></a>00323         
<a name="l00324"></a>00324         
<a name="l00328"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a0709a162451fde0b682f7eed468d8d0a">00328</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a0709a162451fde0b682f7eed468d8d0a" title="finds the number of beats in the song by counting non-zero values in the thinned chunk energy array...">findNumberOfBeats</a>(){
<a name="l00329"></a>00329                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>; i++){
<a name="l00330"></a>00330                         <span class="keywordflow">if</span>(<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a60c09d110a321b808e92cc54dd3caa7b" title="the array obtained after performing thinning on the thresholded array">thinnedChunkEnergy</a>[i] == 1){
<a name="l00331"></a>00331                                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4b8828159722fc47dc8547d35fe8060e" title="number of total beats detected in the song">numOfBeats</a> = <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4b8828159722fc47dc8547d35fe8060e" title="number of total beats detected in the song">numOfBeats</a> + 1;
<a name="l00332"></a>00332                         }
<a name="l00333"></a>00333                 }
<a name="l00334"></a>00334                 <span class="comment">//System.out.println(&quot;num of beats:&quot;+numOfBeats);</span>
<a name="l00335"></a>00335         }
<a name="l00336"></a>00336         
<a name="l00337"></a>00337         
<a name="l00341"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a7f90787ea8404980b102a859dbb0ae83">00341</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a7f90787ea8404980b102a859dbb0ae83" title="creates and initialises the array which holds the chunk location of the beats.">initialiseBeatChunkLocations</a>(){
<a name="l00342"></a>00342                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4" title="the array holds the location corresponding to the beats ( start of a beat)">beatChunkLocations</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4b8828159722fc47dc8547d35fe8060e" title="number of total beats detected in the song">numOfBeats</a>];
<a name="l00343"></a>00343         }
<a name="l00344"></a>00344 
<a name="l00349"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a241155f251735aea7045d95ca64e5f3d">00349</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a241155f251735aea7045d95ca64e5f3d" title="finds the location of beats and fills up the beatChunkLocation array">findBeatChunkLocations</a>(){
<a name="l00350"></a>00350                 <span class="keywordtype">int</span> count = 0;
<a name="l00351"></a>00351                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>; i++){
<a name="l00352"></a>00352                         <span class="keywordflow">if</span>(<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a60c09d110a321b808e92cc54dd3caa7b" title="the array obtained after performing thinning on the thresholded array">thinnedChunkEnergy</a>[i] == 1){
<a name="l00353"></a>00353                                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4" title="the array holds the location corresponding to the beats ( start of a beat)">beatChunkLocations</a>[count] = i;
<a name="l00354"></a>00354                                 count = count + 1;
<a name="l00355"></a>00355                         }
<a name="l00356"></a>00356                 }
<a name="l00357"></a>00357         }
<a name="l00358"></a>00358         
<a name="l00359"></a>00359         
<a name="l00360"></a>00360         
<a name="l00376"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aad9fc191900451deb30f70212f4e0b44">00376</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aad9fc191900451deb30f70212f4e0b44" title="Finds the period of the song in terms of the number of beats in a period.">findNumOfBeatsInPeriod</a>(){
<a name="l00377"></a>00377                 <span class="keywordtype">int</span> max_num_beats_for_period = 10;
<a name="l00378"></a>00378                 <span class="keywordtype">double</span> period_threshold = 50; <span class="comment">// period threshold</span>
<a name="l00379"></a>00379                 <span class="keywordtype">double</span>[] stdev_array = <span class="keyword">new</span> <span class="keywordtype">double</span>[max_num_beats_for_period]; 
<a name="l00380"></a>00380                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; max_num_beats_for_period ; i++){
<a name="l00381"></a>00381                         <span class="keywordtype">double</span> sum_squared = 0;
<a name="l00382"></a>00382                         <span class="keywordtype">double</span> sum = 0;
<a name="l00383"></a>00383                         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0 ; j &lt; <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4b8828159722fc47dc8547d35fe8060e" title="number of total beats detected in the song">numOfBeats</a>-max_num_beats_for_period ; j++){
<a name="l00384"></a>00384                                 sum_squared = sum_squared + (<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4" title="the array holds the location corresponding to the beats ( start of a beat)">beatChunkLocations</a>[j+i+1] - <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4" title="the array holds the location corresponding to the beats ( start of a beat)">beatChunkLocations</a>[j])*(<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4" title="the array holds the location corresponding to the beats ( start of a beat)">beatChunkLocations</a>[j+i+1] - <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4" title="the array holds the location corresponding to the beats ( start of a beat)">beatChunkLocations</a>[j]);
<a name="l00385"></a>00385                                 sum = sum + (<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4" title="the array holds the location corresponding to the beats ( start of a beat)">beatChunkLocations</a>[j+i+1] - <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4" title="the array holds the location corresponding to the beats ( start of a beat)">beatChunkLocations</a>[j]);
<a name="l00386"></a>00386                                 
<a name="l00387"></a>00387                         }
<a name="l00388"></a>00388                         sum = sum/(<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4b8828159722fc47dc8547d35fe8060e" title="number of total beats detected in the song">numOfBeats</a>-max_num_beats_for_period);
<a name="l00389"></a>00389                          sum_squared = sum_squared/(<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4b8828159722fc47dc8547d35fe8060e" title="number of total beats detected in the song">numOfBeats</a>-max_num_beats_for_period);
<a name="l00390"></a>00390                         stdev_array[i] = sum_squared - sum*sum;
<a name="l00391"></a>00391                         <span class="comment">//System.out.println(&quot;stdev_array[&quot;+i+&quot;] : &quot; + stdev_array[i] );</span>
<a name="l00392"></a>00392                 }
<a name="l00393"></a>00393                 
<a name="l00394"></a>00394                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0 ; k &lt; max_num_beats_for_period ; k++){
<a name="l00395"></a>00395                         <span class="keywordflow">if</span>(stdev_array[k] &lt; period_threshold){
<a name="l00396"></a>00396                                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a0c609df4cd08e7f636f54a06fe7cf1d2" title="number of beats in a period ( period represents the repetition period of the song)">numOfBeatsInPeriod</a> = (k+1);
<a name="l00397"></a>00397                                 <span class="keywordflow">break</span>;
<a name="l00398"></a>00398                         }
<a name="l00399"></a>00399                 }
<a name="l00400"></a>00400                 
<a name="l00401"></a>00401         }
<a name="l00402"></a>00402         
<a name="l00407"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a7fdd0e2b02660637b1c8ededa7c88678">00407</a>         <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a7fdd0e2b02660637b1c8ededa7c88678" title="Returns the number of beats in a period.">getNumOfBeatsInPeriod</a>(){
<a name="l00408"></a>00408                 <span class="keywordflow">return</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a0c609df4cd08e7f636f54a06fe7cf1d2" title="number of beats in a period ( period represents the repetition period of the song)">numOfBeatsInPeriod</a>;
<a name="l00409"></a>00409         }
<a name="l00410"></a>00410         
<a name="l00411"></a>00411         
<a name="l00416"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a3af7c6bc6d5985c5e0e43189d9860732">00416</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a3af7c6bc6d5985c5e0e43189d9860732" title="sets the start chunk location, represents the start of the first period">setStartChunkLocation</a>(){
<a name="l00417"></a>00417                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a999b051b96512ab0ccfafd5f4df3b7f5" title="the chunk index which corresponds to the first beat, also the start of the first period.">startChunkLocation</a> = <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4" title="the array holds the location corresponding to the beats ( start of a beat)">beatChunkLocations</a>[0];
<a name="l00418"></a>00418         }
<a name="l00419"></a>00419 
<a name="l00420"></a>00420         
<a name="l00426"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a3268e2176656389ad8bd1df2a55e7d96">00426</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a3268e2176656389ad8bd1df2a55e7d96" title="sets the period int terms of number of chunks">setperiodInChunks</a>(){
<a name="l00427"></a>00427                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a215d72d494726c9ffc7a83f5645fda6d" title="the period/tempo of the song as the number of chunks">periodInChunks</a> = <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4" title="the array holds the location corresponding to the beats ( start of a beat)">beatChunkLocations</a>[<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a0c609df4cd08e7f636f54a06fe7cf1d2" title="number of beats in a period ( period represents the repetition period of the song)">numOfBeatsInPeriod</a>] - <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a999b051b96512ab0ccfafd5f4df3b7f5" title="the chunk index which corresponds to the first beat, also the start of the first period.">startChunkLocation</a>;
<a name="l00428"></a>00428         }
<a name="l00429"></a>00429         
<a name="l00434"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#af3a27886b988c9329880e942f98dda00">00434</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#af3a27886b988c9329880e942f98dda00" title="finds the tempo in the song.">findTempo</a>(){
<a name="l00435"></a>00435                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a0709a162451fde0b682f7eed468d8d0a" title="finds the number of beats in the song by counting non-zero values in the thinned chunk energy array...">findNumberOfBeats</a>();
<a name="l00436"></a>00436                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a7f90787ea8404980b102a859dbb0ae83" title="creates and initialises the array which holds the chunk location of the beats.">initialiseBeatChunkLocations</a>();
<a name="l00437"></a>00437                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a241155f251735aea7045d95ca64e5f3d" title="finds the location of beats and fills up the beatChunkLocation array">findBeatChunkLocations</a>();
<a name="l00438"></a>00438                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aad9fc191900451deb30f70212f4e0b44" title="Finds the period of the song in terms of the number of beats in a period.">findNumOfBeatsInPeriod</a>();
<a name="l00439"></a>00439                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a3af7c6bc6d5985c5e0e43189d9860732" title="sets the start chunk location, represents the start of the first period">setStartChunkLocation</a>();
<a name="l00440"></a>00440                 <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a3268e2176656389ad8bd1df2a55e7d96" title="sets the period int terms of number of chunks">setperiodInChunks</a>();
<a name="l00441"></a>00441         }
<a name="l00442"></a>00442                 
<a name="l00443"></a>00443         
<a name="l00444"></a>00444         
<a name="l00445"></a>00445         
<a name="l00453"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#acd6af167b4491c88f531d7e17949002f">00453</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#acd6af167b4491c88f531d7e17949002f" title="prints the thinned chunk energies per chunk to a file">printThinnedChunkEnergies</a>(String fileName) {
<a name="l00454"></a>00454                 <span class="keywordflow">try</span> {
<a name="l00455"></a>00455                         <span class="comment">//System.out.println(&quot;num of chunks: &quot; + numOfChunks);</span>
<a name="l00456"></a>00456                         FileWriter fw = <span class="keyword">new</span> FileWriter(fileName);
<a name="l00457"></a>00457                         PrintWriter pw = <span class="keyword">new</span> PrintWriter(fw);
<a name="l00458"></a>00458                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>; i++) {
<a name="l00459"></a>00459                                 pw.println(<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a60c09d110a321b808e92cc54dd3caa7b" title="the array obtained after performing thinning on the thresholded array">thinnedChunkEnergy</a>[i]);
<a name="l00460"></a>00460                         }
<a name="l00461"></a>00461 
<a name="l00462"></a>00462                         pw.close();
<a name="l00463"></a>00463                         fw.close();
<a name="l00464"></a>00464                 } <span class="keywordflow">catch</span> (FileNotFoundException e) {
<a name="l00465"></a>00465                         e.printStackTrace();
<a name="l00466"></a>00466                 } <span class="keywordflow">catch</span> (IOException e) {
<a name="l00467"></a>00467                         e.printStackTrace();
<a name="l00468"></a>00468                 }
<a name="l00469"></a>00469         }
<a name="l00470"></a>00470 
<a name="l00471"></a>00471         
<a name="l00472"></a>00472         
<a name="l00473"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a5800f15a15818c2339913e36c03c1ea7">00473</a>         <span class="keyword">public</span> <span class="keywordtype">short</span>[] <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a5800f15a15818c2339913e36c03c1ea7">getThinnedChunkEnergy</a>() {
<a name="l00474"></a>00474                 <span class="keywordflow">return</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a60c09d110a321b808e92cc54dd3caa7b" title="the array obtained after performing thinning on the thresholded array">thinnedChunkEnergy</a>;
<a name="l00475"></a>00475         }
<a name="l00476"></a>00476 
<a name="l00477"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a6ac21e06245fa36ddb32a95e6193b01f">00477</a>         <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a6ac21e06245fa36ddb32a95e6193b01f">getNumOfSamples</a>() {
<a name="l00478"></a>00478                 <span class="keywordflow">return</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ac8c95aea3c979efe3fed52098479b80d" title="total number of samples in the song">numOfSamples</a>;
<a name="l00479"></a>00479         }
<a name="l00480"></a>00480 
<a name="l00481"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a5b4cb501e57ea8f8d08a2b2441390c81">00481</a>         <span class="keyword">public</span> <span class="keywordtype">short</span>[] <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a5b4cb501e57ea8f8d08a2b2441390c81">getAmplitudes</a>() {
<a name="l00482"></a>00482                 <span class="keywordflow">return</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a9a258dda32e242f513ef26aa60446df7" title="the array of amplitudes for every sample">amplitudes</a>;
<a name="l00483"></a>00483         }
<a name="l00484"></a>00484 
<a name="l00485"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aef58b9af346480a1fa652920b0e6f7e5">00485</a>         <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aef58b9af346480a1fa652920b0e6f7e5">getSamplingRate</a>() {
<a name="l00486"></a>00486                 <span class="keywordflow">return</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#afcc7e14849a5a6b6e2adb80336f0845f" title="the sampling rate of the song.">samplingRate</a>;
<a name="l00487"></a>00487         }
<a name="l00488"></a>00488 
<a name="l00489"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ada839594ec15b56ccf5fec6665e015c5">00489</a>         <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ada839594ec15b56ccf5fec6665e015c5">getNumOfChunks</a>() {
<a name="l00490"></a>00490                 <span class="keywordflow">return</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2641420cf8653585ff7701da3f146e19" title="the total number of chunks in the song.">numOfChunks</a>;
<a name="l00491"></a>00491         }
<a name="l00492"></a>00492 
<a name="l00493"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a07a2117cf9e9c73aa32126d3c8a3910d">00493</a>         <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a07a2117cf9e9c73aa32126d3c8a3910d">getSizeOfChunk</a>() {
<a name="l00494"></a>00494                 <span class="keywordflow">return</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aab0fed93a02fa372754b110eed17a087" title="size of a chunk : represents the number of samples in a chunk.">sizeOfChunk</a>;
<a name="l00495"></a>00495         }
<a name="l00496"></a>00496 
<a name="l00497"></a>00497         
<a name="l00498"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a0f00fb7eef2038d2355828c0217d239d">00498</a>         <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a0f00fb7eef2038d2355828c0217d239d">getStartChunkLocation</a>() {
<a name="l00499"></a>00499                 <span class="keywordflow">return</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a999b051b96512ab0ccfafd5f4df3b7f5" title="the chunk index which corresponds to the first beat, also the start of the first period.">startChunkLocation</a>;
<a name="l00500"></a>00500         }
<a name="l00501"></a>00501 
<a name="l00502"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2314b9474f94b032b6e5784f29205dfa">00502</a>         <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a2314b9474f94b032b6e5784f29205dfa">getPeriodInChunks</a>() {
<a name="l00503"></a>00503                 <span class="keywordflow">return</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a215d72d494726c9ffc7a83f5645fda6d" title="the period/tempo of the song as the number of chunks">periodInChunks</a>;
<a name="l00504"></a>00504         }
<a name="l00505"></a>00505         
<a name="l00506"></a>00506         
<a name="l00507"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a3c48bf5bba3569ea573f6f7f6fa0014f">00507</a>         <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a3c48bf5bba3569ea573f6f7f6fa0014f">getStartSampleLocation</a>() {
<a name="l00508"></a>00508                 <span class="keywordflow">return</span> (<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a999b051b96512ab0ccfafd5f4df3b7f5" title="the chunk index which corresponds to the first beat, also the start of the first period.">startChunkLocation</a>*<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aab0fed93a02fa372754b110eed17a087" title="size of a chunk : represents the number of samples in a chunk.">sizeOfChunk</a>);
<a name="l00509"></a>00509         }
<a name="l00510"></a>00510 
<a name="l00511"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a8b2b91ca30a85a58e58b5d13405932e8">00511</a>         <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a8b2b91ca30a85a58e58b5d13405932e8">getPeriodInSamples</a>() {
<a name="l00512"></a>00512                 <span class="keywordflow">return</span> (<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a215d72d494726c9ffc7a83f5645fda6d" title="the period/tempo of the song as the number of chunks">periodInChunks</a>*<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aab0fed93a02fa372754b110eed17a087" title="size of a chunk : represents the number of samples in a chunk.">sizeOfChunk</a>);
<a name="l00513"></a>00513         }
<a name="l00514"></a>00514 
<a name="l00515"></a>00515         <span class="comment">// 0th beat ---- first beat.</span>
<a name="l00516"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a61744df19ec879f1c12002b430b4490e">00516</a>         <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a61744df19ec879f1c12002b430b4490e">getBeatLocationInSamples</a>(<span class="keywordtype">int</span> beat_number){
<a name="l00517"></a>00517                 <span class="keywordtype">int</span> location = <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#aab0fed93a02fa372754b110eed17a087" title="size of a chunk : represents the number of samples in a chunk.">sizeOfChunk</a>*<a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab144844f9b2924daf73e3af0d863add4" title="the array holds the location corresponding to the beats ( start of a beat)">beatChunkLocations</a>[beat_number];
<a name="l00518"></a>00518                 <span class="keywordflow">return</span> location;
<a name="l00519"></a>00519         }
<a name="l00520"></a>00520 
<a name="l00521"></a><a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab4889dbe40eea116afdf6a4bb613b589">00521</a>         <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#ab4889dbe40eea116afdf6a4bb613b589">getNumOfBeats</a>() {
<a name="l00522"></a>00522                 <span class="keywordflow">return</span> <a class="code" href="classcom_1_1iitb_1_1beatdetector_1_1BeatDetector.html#a4b8828159722fc47dc8547d35fe8060e" title="number of total beats detected in the song">numOfBeats</a>;
<a name="l00523"></a>00523         }
<a name="l00524"></a>00524         
<a name="l00525"></a>00525         
<a name="l00526"></a>00526         
<a name="l00527"></a>00527 }
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="BeatDetector_8java.html">BeatDetector.java</a>      </li>

    <li class="footer">Generated on Sat Nov 17 2012 02:26:22 for Dancing Hexapod by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
